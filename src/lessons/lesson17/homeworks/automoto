/**
 * Класс игрового автомата
 * 
 * Правила объявления полей:
 * - val: неизменяемое поле (read-only), устанавливается один раз
 * - var: изменяемое поле (mutable), может изменяться
 * - private: доступно только внутри класса
 * - без модификатора: по умолчанию public в Kotlin
 */
class ИгровойАвтомат(
    val цвет: String,                    // val - не меняется после инициализации
    val модель: String,                  // val - постоянная характеристика
    val наличиеДжойстика: Boolean,      // val - характеристика оборудования
    val владелец: String,                // val - не меняется
    val телефонПоддержки: String,       // val - константная информация
    private val стоимостьСеанса: Double, // private val - скрытая константа
    private val пинКод: String           // private val - секретная информация
) {
    // Изменяемые поля состояния
    var включен: Boolean = false              // var - состояние меняется
        private set                            // setter приватный - изменять только внутри класса
    
    var осЗагружена: Boolean = false          // var - состояние меняется
        private set
    
    var игровойСеансОплачен: Boolean = false  // var - состояние меняется
        private set
    
    private var балансВырученныхСредств: Double = 0.0  // private var - внутренние данные
    
    private val списокУстановленныхИгр: MutableList<String> = mutableListOf(
        "Pac-Man", "Street Fighter", "Mortal Kombat"
    )
    
    // Публичные методы управления
    
    fun включить() {
        if (!включен) {
            включен = true
            println("Игровой автомат включен")
        } else {
            println("Автомат уже включен")
        }
    }
    
    fun выключить() {
        if (включен) {
            if (осЗагружена) {
                завершитьРаботуОС()
            }
            включен = false
            println("Игровой автомат выключен")
        } else {
            println("Автомат уже выключен")
        }
    }
    
    fun загрузитьОС() {
        if (включен && !осЗагружена) {
            осЗагружена = true
            println("Операционная система загружена")
        } else if (!включен) {
            println("Ошибка: сначала включите автомат")
        } else {
            println("ОС уже загружена")
        }
    }
    
    fun завершитьРаботуОС() {
        if (осЗагружена) {
            игровойСеансОплачен = false
            осЗагружена = false
            println("Операционная система завершила работу")
        }
    }
    
    fun показатьСписокИгр(): List<String> {
        return if (осЗагружена) {
            println("Доступные игры:")
            списокУстановленныхИгр.forEachIndexed { index, игра ->
                println("${index + 1}. $игра")
            }
            списокУстановленныхИгр.toList()  // Возвращаем копию для безопасности
        } else {
            println("Ошибка: сначала загрузите ОС")
            emptyList()
        }
    }
    
    fun включитьИгру(номерИгры: Int): Boolean {
        return if (осЗагружена && игровойСеансОплачен) {
            if (номерИгры in 1..списокУстановленныхИгр.size) {
                val игра = списокУстановленныхИгр[номерИгры - 1]
                println("Запуск игры: $игра")
                true
            } else {
                println("Ошибка: игра с номером $номерИгры не найдена")
                false
            }
        } else if (!осЗагружена) {
            println("Ошибка: сначала загрузите ОС")
            false
        } else {
            println("Ошибка: оплатите игровой сеанс")
            false
        }
    }
    
    fun оплатитьИгровойСеанс(сумма: Double): Boolean {
        return if (осЗагружена) {
            if (сумма >= стоимостьСеанса) {
                игровойСеансОплачен = true
                балансВырученныхСредств += сумма
                println("Игровой сеанс оплачен. Внесено: $сумма руб.")
                true
            } else {
                println("Недостаточно средств. Требуется: $стоимостьСеанса руб.")
                false
            }
        } else {
            println("Ошибка: сначала загрузите ОС")
            false
        }
    }
    
    fun забратьНаличныеСПомощьюПинКода(введенныйПинКод: String): Boolean {
        return if (введенныйПинКод == пинКод) {
            println("Пин-код верный. Доступ к сейфу разрешен")
            открытьСейфИВыдатьНаличные()
            true
        } else {
            println("Неверный пин-код. Доступ запрещен")
            false
        }
    }
    
    // Приватный метод - используется только внутри класса
    private fun открытьСейфИВыдатьНаличные() {
        if (балансВырученныхСредств > 0) {
            println("Выдача наличных: $балансВырученныхСредств руб.")
            балансВырученныхСредств = 0.0
            println("Сейф пуст")
        } else {
            println("В сейфе нет денег")
        }
    }
    
    // Дополнительные методы для демонстрации
    fun получитьБаланс(пинКод: String): Double? {
        return if (пинКод == this.пинКод) {
            балансВырученныхСредств
        } else {
            println("Неверный пин-код")
            null
        }
    }
}
